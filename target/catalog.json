{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/catalog/v1.json", "dbt_version": "1.10.5", "generated_at": "2025-07-28T11:56:20.698625Z", "invocation_id": "f76cab0c-5f97-4ffa-a4e9-a13da0c58f60", "invocation_started_at": "2025-07-28T11:56:11.915349Z", "env": {}}, "nodes": {"model.dbt_chess.stg__player_games": {"metadata": {"type": "table", "schema": "dev_staging", "name": "stg__player_games", "database": "checkmate-453316", "comment": "Stage model that transforms raw chess game data into a player-level view,  with one row per player per game (both white and black perspectives).  Includes standardizations for result classification (win/loss/draw),  basic game metadata, and parsed opening names. This model supports  incremental loads by game date for efficient backfills.\n", "owner": null}, "columns": {"game_id": {"type": "INT64", "index": 1, "name": "game_id", "comment": "Unique identifier of the chess game."}, "game_date": {"type": "DATE", "index": 2, "name": "game_date", "comment": "The date the game was played, used for partitioning."}, "username": {"type": "STRING", "index": 3, "name": "username", "comment": "Username of the player (either white or black)."}, "rating": {"type": "INT64", "index": 4, "name": "rating", "comment": "Player's rating at the time the game was played."}, "piece_color": {"type": "STRING", "index": 5, "name": "piece_color", "comment": "Color the player was playing in the game (`white` or `black`)."}, "time_class": {"type": "STRING", "index": 6, "name": "time_class", "comment": "Time control category of the game (e.g., blitz, rapid, bullet)."}, "rules": {"type": "STRING", "index": 7, "name": "rules", "comment": "Game variant or ruleset (typically `chess` for standard games)."}, "raw_result": {"type": "STRING", "index": 8, "name": "raw_result", "comment": "Raw result string as recorded in the source data (e.g., win, resigned, stalemate)."}, "rated": {"type": "BOOL", "index": 9, "name": "rated", "comment": "Boolean flag indicating whether the game was rated."}, "win_loss_draw": {"type": "STRING", "index": 10, "name": "win_loss_draw", "comment": "Normalized result classification with values `win`, `loss`, or `draw` based on `raw_result`."}, "opening_line": {"type": "STRING", "index": 11, "name": "opening_line", "comment": "Full ECO-style opening line (e.g., \"1.e4 e5 2.Nf3 Nc6\")."}, "opening": {"type": "STRING", "index": 12, "name": "opening", "comment": "Cleaned opening name with move numbers and continuation symbols removed, for grouping purposes."}, "accuracy": {"type": "FLOAT64", "index": 13, "name": "accuracy", "comment": "Accuracy score for the player in the game, as provided by the source."}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 601182876, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "partitioning_type": {"id": "partitioning_type", "label": "Partitioned By", "value": "game_date", "include": true, "description": "The partitioning column for this table"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 4121436, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "model.dbt_chess.stg__player_games"}, "model.dbt_chess.quarterly_chess_player_metrics": {"metadata": {"type": "table", "schema": "dev_marts", "name": "quarterly_chess_player_metrics", "database": "checkmate-453316", "comment": "Aggregates player game statistics by quarter, time class, and opening archetype. This model provides breakdowns of game outcomes (win/loss/draw) and average accuracy by piece color (white/black) for rated standard chess games. It uses calendar and opening mapping tables to enrich the game data, and filters to only include recent games based on configurable date logic.\n", "owner": null}, "columns": {"quarter_start_date": {"type": "DATE", "index": 1, "name": "quarter_start_date", "comment": "The first calendar date of the quarter during which the games were played."}, "year_quarter": {"type": "STRING", "index": 2, "name": "year_quarter", "comment": "The year and quarter in the format YYYYQn (e.g., 2024Q1)."}, "username": {"type": "STRING", "index": 3, "name": "username", "comment": "Chess.com username of the player."}, "time_class": {"type": "STRING", "index": 4, "name": "time_class", "comment": "Time control classification of the game (e.g., blitz, rapid, bullet)."}, "opening_archetype": {"type": "STRING", "index": 5, "name": "opening_archetype", "comment": "High-level categorization of the opening played. Defaults to \"Mapping Failed\" if unmapped."}, "total_games": {"type": "INT64", "index": 6, "name": "total_games", "comment": "Total number of rated standard chess games played by the user in the quarter under the given opening archetype and time class."}, "white_win_count": {"type": "INT64", "index": 7, "name": "white_win_count", "comment": "Number of games won while playing as white."}, "white_loss_count": {"type": "INT64", "index": 8, "name": "white_loss_count", "comment": "Number of games lost while playing as white."}, "white_draw_count": {"type": "INT64", "index": 9, "name": "white_draw_count", "comment": "Number of games drawn while playing as white."}, "white_accuracy": {"type": "FLOAT64", "index": 10, "name": "white_accuracy", "comment": "Average accuracy in games played as white."}, "black_win_count": {"type": "INT64", "index": 11, "name": "black_win_count", "comment": "Number of games won while playing as black."}, "black_loss_count": {"type": "INT64", "index": 12, "name": "black_loss_count", "comment": "Number of games lost while playing as black."}, "black_draw_count": {"type": "INT64", "index": 13, "name": "black_draw_count", "comment": "Number of games drawn while playing as black."}, "black_accuracy": {"type": "FLOAT64", "index": 14, "name": "black_accuracy", "comment": "Average accuracy in games played as black."}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 89683274, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "clustering_fields": {"id": "clustering_fields", "label": "Clustered By", "value": "username, opening_archetype, time_class", "include": true, "description": "The clustering columns for this table"}, "partitioning_type": {"id": "partitioning_type", "label": "Partitioned By", "value": "quarter_start_date", "include": true, "description": "The partitioning column for this table"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 785474, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "model.dbt_chess.quarterly_chess_player_metrics"}, "model.dbt_chess.weekly_chess_player_metrics": {"metadata": {"type": "table", "schema": "dev_marts", "name": "weekly_chess_player_metrics", "database": "checkmate-453316", "comment": "Weekly aggregate statistics of rated standard chess games by player, piece color, and time class. This model calculates performance metrics such as win/loss/draw counts, accuracy, and rating, separated by white and black games. It uses the calendar table to align games to ISO week start dates and is designed for incremental refresh with weekly partitioning and clustering.\n", "owner": null}, "columns": {"week_start_date": {"type": "DATE", "index": 1, "name": "week_start_date", "comment": "The ISO calendar start date (Monday) for the week in which the games were played."}, "week_number": {"type": "STRING", "index": 2, "name": "week_number", "comment": "The ISO week label in the format YYYY-WW (e.g., 2024-W05)."}, "username": {"type": "STRING", "index": 3, "name": "username", "comment": "Chess.com username of the player."}, "time_class": {"type": "STRING", "index": 4, "name": "time_class", "comment": "Time control classification of the game (e.g., blitz, rapid, bullet)."}, "avg_rating": {"type": "FLOAT64", "index": 5, "name": "avg_rating", "comment": "Average rating of the player across all games played in the week."}, "total_games": {"type": "INT64", "index": 6, "name": "total_games", "comment": "Total number of rated standard chess games played in the week by the user for the given time class."}, "white_win_count": {"type": "INT64", "index": 7, "name": "white_win_count", "comment": "Number of games won while playing as white."}, "white_loss_count": {"type": "INT64", "index": 8, "name": "white_loss_count", "comment": "Number of games lost while playing as white."}, "white_draw_count": {"type": "INT64", "index": 9, "name": "white_draw_count", "comment": "Number of games drawn while playing as white."}, "white_accuracy": {"type": "FLOAT64", "index": 10, "name": "white_accuracy", "comment": "Average move accuracy in games played as white."}, "black_win_count": {"type": "INT64", "index": 11, "name": "black_win_count", "comment": "Number of games won while playing as black."}, "black_loss_count": {"type": "INT64", "index": 12, "name": "black_loss_count", "comment": "Number of games lost while playing as black."}, "black_draw_count": {"type": "INT64", "index": 13, "name": "black_draw_count", "comment": "Number of games drawn while playing as black."}, "black_accuracy": {"type": "FLOAT64", "index": 14, "name": "black_accuracy", "comment": "Average move accuracy in games played as black."}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 68051216, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "clustering_fields": {"id": "clustering_fields", "label": "Clustered By", "value": "username, time_class", "include": true, "description": "The clustering columns for this table"}, "partitioning_type": {"id": "partitioning_type", "label": "Partitioned By", "value": "week_start_date", "include": true, "description": "The partitioning column for this table"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 654955, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "model.dbt_chess.weekly_chess_player_metrics"}, "model.dbt_chess.calendar": {"metadata": {"type": "table", "schema": "dev_universal", "name": "calendar", "database": "checkmate-453316", "comment": "Calendar table with wide-combination of values and formats accounting for days/weeks/months/quarters/years", "owner": null}, "columns": {"cal_date": {"type": "DATE", "index": 1, "name": "cal_date", "comment": "The calendar date represented at the daily granularity"}, "day": {"type": "INT64", "index": 2, "name": "day", "comment": "Day Number"}, "week": {"type": "INT64", "index": 3, "name": "week", "comment": "Week Number (Starting Sunday)"}, "iso_week": {"type": "INT64", "index": 4, "name": "iso_week", "comment": "Week Number (Starting Monday)"}, "month": {"type": "INT64", "index": 5, "name": "month", "comment": "Month Number"}, "quarter": {"type": "INT64", "index": 6, "name": "quarter", "comment": "Quarter Number"}, "year": {"type": "INT64", "index": 7, "name": "year", "comment": "Year Number"}, "month_name": {"type": "STRING", "index": 8, "name": "month_name", "comment": "Name of Month"}, "year_quarter": {"type": "STRING", "index": 9, "name": "year_quarter", "comment": "Year and Quarter based on cal_date"}, "quarter_start_date": {"type": "DATE", "index": 10, "name": "quarter_start_date", "comment": "Quarter Start Date"}, "quarter_end_date": {"type": "DATE", "index": 11, "name": "quarter_end_date", "comment": "Quarter End Date"}, "month_start_date": {"type": "DATE", "index": 12, "name": "month_start_date", "comment": "Month Start Date"}, "month_end_date": {"type": "DATE", "index": 13, "name": "month_end_date", "comment": "Month End Date"}, "month_year_short": {"type": "STRING", "index": 14, "name": "month_year_short", "comment": "Month Year in the format %b-%y"}, "month_year_full": {"type": "STRING", "index": 15, "name": "month_year_full", "comment": "Month Year in the format %B-%Y"}, "iso_week_desc": {"type": "STRING", "index": 16, "name": "iso_week_desc", "comment": "ISO Week Number in the format 'Week' {number}"}, "iso_week_start_date": {"type": "DATE", "index": 17, "name": "iso_week_start_date", "comment": "ISO Week Start Date (Starting Monday)"}, "iso_week_end_date": {"type": "DATE", "index": 18, "name": "iso_week_end_date", "comment": "ISO Week End Date (Ending Sunday)"}, "week_number_desc": {"type": "STRING", "index": 19, "name": "week_number_desc", "comment": "Week Number in the format 'Week' {number}"}, "week_start_date": {"type": "DATE", "index": 20, "name": "week_start_date", "comment": "Week End Date (Starting Sunday)"}, "week_end_date": {"type": "DATE", "index": 21, "name": "week_end_date", "comment": "Week End Date (Ending Saturday)"}, "flag_current_year": {"type": "BOOL", "index": 22, "name": "flag_current_year", "comment": "Flag days in the current year"}, "flag_1st_previous_year": {"type": "BOOL", "index": 23, "name": "flag_1st_previous_year", "comment": "Flag days in the previous year"}, "flag_2nd_previous_year": {"type": "BOOL", "index": 24, "name": "flag_2nd_previous_year", "comment": "Flag days in the year before the previous year"}, "flag_current_last_12_months": {"type": "BOOL", "index": 25, "name": "flag_current_last_12_months", "comment": "Flag days in the last 12 months from today"}, "flag_previous_last_12_months": {"type": "BOOL", "index": 26, "name": "flag_previous_last_12_months", "comment": "Flag days in the last 12 months from today's date last year"}, "flag_current_quarter": {"type": "BOOL", "index": 27, "name": "flag_current_quarter", "comment": "Flag days in the current calendar quarter"}, "flag_1st_previous_quarter": {"type": "BOOL", "index": 28, "name": "flag_1st_previous_quarter", "comment": "Flag days in the previous calendar quarter"}, "flag_2nd_previous_quarter": {"type": "BOOL", "index": 29, "name": "flag_2nd_previous_quarter", "comment": "Flag days in the calendar quarter before the previous one"}, "flag_current_quarter_last_year": {"type": "BOOL", "index": 30, "name": "flag_current_quarter_last_year", "comment": "Flag days in the current calendar quarter from last year"}, "flag_1st_previous_quarter_last_year": {"type": "BOOL", "index": 31, "name": "flag_1st_previous_quarter_last_year", "comment": "Flag days in the previous calendar quarter from last year"}, "flag_2nd_previous_quarter_last_year": {"type": "BOOL", "index": 32, "name": "flag_2nd_previous_quarter_last_year", "comment": "Flag days in the calendar quarter before the previous one from last year"}, "flag_current_month": {"type": "BOOL", "index": 33, "name": "flag_current_month", "comment": "Flag days in the current month"}, "flag_1st_previous_month": {"type": "BOOL", "index": 34, "name": "flag_1st_previous_month", "comment": "Flag days in the previous month"}, "flag_2nd_previous_month": {"type": "BOOL", "index": 35, "name": "flag_2nd_previous_month", "comment": "Flag days in the month before the previous month"}, "flag_current_month_last_year": {"type": "BOOL", "index": 36, "name": "flag_current_month_last_year", "comment": "Flag days in the current month from last year"}, "flag_1st_previous_month_last_year": {"type": "BOOL", "index": 37, "name": "flag_1st_previous_month_last_year", "comment": "Flag days in the previous month from last year"}, "flag_2nd_previous_month_last_year": {"type": "BOOL", "index": 38, "name": "flag_2nd_previous_month_last_year", "comment": "Flag days in the month before the previous month from last year"}, "flag_current_week": {"type": "BOOL", "index": 39, "name": "flag_current_week", "comment": "Flag days in the current calendar week (starting Sunday)"}, "flag_1st_previous_week": {"type": "BOOL", "index": 40, "name": "flag_1st_previous_week", "comment": "Flag days in the previous calendar week (starting Sunday)"}, "flag_2nd_previous_week": {"type": "BOOL", "index": 41, "name": "flag_2nd_previous_week", "comment": "Flag days in the calendar week before the previous one (starting Sunday)"}, "flag_current_week_last_year": {"type": "BOOL", "index": 42, "name": "flag_current_week_last_year", "comment": "Flag days in the current calendar week from last year (starting Sunday)"}, "flag_1st_previous_week_last_year": {"type": "BOOL", "index": 43, "name": "flag_1st_previous_week_last_year", "comment": "Flag days in the previous calendar week from last year (starting Sunday)"}, "flag_2nd_previous_week_last_year": {"type": "BOOL", "index": 44, "name": "flag_2nd_previous_week_last_year", "comment": "Flag days in the calendar week before the previous one from last year (starting Sunday)"}, "flag_current_iso_week": {"type": "BOOL", "index": 45, "name": "flag_current_iso_week", "comment": "Flag days in the current ISO week (starting Monday)"}, "flag_1st_previous_iso_week": {"type": "BOOL", "index": 46, "name": "flag_1st_previous_iso_week", "comment": "Flag days in the previous ISO week (starting Monday)"}, "flag_2nd_previous_iso_week": {"type": "BOOL", "index": 47, "name": "flag_2nd_previous_iso_week", "comment": "Flag days in the ISO week before the previous one (starting Monday)"}, "flag_current_iso_week_last_year": {"type": "BOOL", "index": 48, "name": "flag_current_iso_week_last_year", "comment": "Flag days in the current ISO week from last year (starting Monday)"}, "flag_1st_previous_iso_week_last_year": {"type": "BOOL", "index": 49, "name": "flag_1st_previous_iso_week_last_year", "comment": "Flag days in the previous ISO week from last year (starting Monday)"}, "flag_2nd_previous_iso_week_last_year": {"type": "BOOL", "index": 50, "name": "flag_2nd_previous_iso_week_last_year", "comment": "Flag days in the ISO week before the previous one from last year (starting Monday)"}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 748265, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 3651, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "model.dbt_chess.calendar"}, "seed.dbt_chess.opening_mapping": {"metadata": {"type": "table", "schema": "dev_universal", "name": "opening_mapping", "database": "checkmate-453316", "comment": null, "owner": null}, "columns": {"opening": {"type": "STRING", "index": 1, "name": "opening", "comment": ""}, "opening_archetype": {"type": "STRING", "index": 2, "name": "opening_archetype", "comment": ""}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 145929, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 2263, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "seed.dbt_chess.opening_mapping"}}, "sources": {"source.dbt_chess.chess_raw.games": {"metadata": {"type": "table", "schema": "chess_raw", "name": "games", "database": "checkmate-453316", "comment": null, "owner": null}, "columns": {"game_id": {"type": "INT64", "index": 1, "name": "game_id", "comment": "The ID of the chess game played"}, "url": {"type": "STRING", "index": 2, "name": "url", "comment": "The URL of the chess game played"}, "game_date": {"type": "DATE", "index": 3, "name": "game_date", "comment": "The date of the chess game played"}, "ingested_dt": {"type": "TIMESTAMP", "index": 4, "name": "ingested_dt", "comment": "The timestamp of the ingested data"}, "time_control": {"type": "STRING", "index": 5, "name": "time_control", "comment": "The time control of the chess game played"}, "end_time": {"type": "INT64", "index": 6, "name": "end_time", "comment": "The timestamp at which the game ended"}, "rated": {"type": "BOOL", "index": 7, "name": "rated", "comment": "Flag for identifying if the game was rated"}, "time_class": {"type": "STRING", "index": 8, "name": "time_class", "comment": "The time classification for the game"}, "rules": {"type": "STRING", "index": 9, "name": "rules", "comment": "The chess ruleset of the respective chess game"}, "white": {"type": "STRUCT<uuid STRING, username STRING, rating INT64, result STRING>", "index": 10, "name": "white", "comment": "White player details"}, "white.rating": {"type": "INT64", "index": 11, "name": "white.rating", "comment": "The rating of the chess player at the time of the game"}, "white.result": {"type": "STRING", "index": 12, "name": "white.result", "comment": "The result of the respective chess game"}, "white.username": {"type": "STRING", "index": 13, "name": "white.username", "comment": "The username of the chess player"}, "white.uuid": {"type": "STRING", "index": 14, "name": "white.uuid", "comment": "The unique identifier of a player's username"}, "black": {"type": "STRUCT<uuid STRING, username STRING, rating INT64, result STRING>", "index": 15, "name": "black", "comment": "Black player details"}, "black.rating": {"type": "INT64", "index": 16, "name": "black.rating", "comment": "The rating of the chess player at the time of the game"}, "black.result": {"type": "STRING", "index": 17, "name": "black.result", "comment": "The result of the respective chess game"}, "black.username": {"type": "STRING", "index": 18, "name": "black.username", "comment": "The username of the chess player"}, "black.uuid": {"type": "STRING", "index": 19, "name": "black.uuid", "comment": "The unique identifier of a player's username"}, "accuracies": {"type": "STRUCT<white FLOAT64, black FLOAT64>", "index": 20, "name": "accuracies", "comment": "Player accuracies"}, "accuracies.black": {"type": "FLOAT64", "index": 21, "name": "accuracies.black", "comment": "Black - The accuracy of the respective chess game"}, "accuracies.white": {"type": "FLOAT64", "index": 22, "name": "accuracies.white", "comment": "White - The accuracy of the respective chess game"}, "eco": {"type": "STRING", "index": 23, "name": "eco", "comment": "The Encyclopedia of Chess Openings URL for the chess opening played"}, "opening": {"type": "STRING", "index": 24, "name": "opening", "comment": "The name of the chess opening played"}}, "stats": {"num_bytes": {"id": "num_bytes", "label": "Approximate Size", "value": 703854983, "include": true, "description": "Approximate size of table as reported by BigQuery"}, "partitioning_type": {"id": "partitioning_type", "label": "Partitioned By", "value": "game_date", "include": true, "description": "The partitioning column for this table"}, "num_rows": {"id": "num_rows", "label": "# Rows", "value": 2060718, "include": true, "description": "Approximate count of rows in this table"}, "has_stats": {"id": "has_stats", "label": "Has Stats?", "value": true, "include": false, "description": "Indicates whether there are statistics for this table"}}, "unique_id": "source.dbt_chess.chess_raw.games"}}, "errors": null}